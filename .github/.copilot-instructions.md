# Habit Tracker App - Instructions pour Copilot

Ce projet est une application de suivi d'habitudes (Habit Tracker) dÃ©veloppÃ©e avec Next.js, TypeScript, et TailwindCSS.

## ğŸ‰ Statut du projet : APPLICATION FONCTIONNELLE

L'application est **100% opÃ©rationnelle** avec :
- âœ… Interface moderne complÃ¨te (design rose/pink)
- âœ… Base de donnÃ©es Prisma configurÃ©e et initialisÃ©e
- âœ… Authentification NextAuth.js prÃªte
- âœ… Navigation complÃ¨te et responsive
- âœ… Toutes les pages fonctionnelles

## Architecture du projet

### Stack technique
- **Frontend**: Next.js 15, React 19, TypeScript
- **Backend**: API Routes Next.js + Server Actions
- **Base de donnÃ©es**: PostgreSQL (Neon) avec Prisma ORM
- **Authentification**: NextAuth.js v5
- **Styling**: TailwindCSS + Heroicons

### Structure des dossiers
```
app/
â”œâ”€â”€ page.tsx             # Landing page
â”œâ”€â”€ login/               # Page de connexion
â”œâ”€â”€ signup/              # Page d'inscription
â”œâ”€â”€ dashboard/           # Interface principale
â”‚   â”œâ”€â”€ page.tsx        # Dashboard avec stats
â”‚   â”œâ”€â”€ activities/      # Gestion des habitudes
â”‚   â”œâ”€â”€ profile/         # Statistiques utilisateur
â”‚   â”œâ”€â”€ challenges/      # DÃ©fis (V2)
â”‚   â””â”€â”€ settings/        # ParamÃ¨tres (avec sÃ©lection de thÃ¨me)
â”œâ”€â”€ context/
â”‚   â””â”€â”€ ThemeContext.tsx # Contexte de thÃ¨me (sans rechargement)
â”œâ”€â”€ api/                 # API Routes
â”‚   â””â”€â”€ auth/
â”œâ”€â”€ lib/                 # Utilitaires
â”‚   â”œâ”€â”€ prisma.ts       # Client Prisma singleton
â”‚   â”œâ”€â”€ actions.ts      # Server actions
â”‚   â”œâ”€â”€ themes.ts       # Configuration des 5 thÃ¨mes
â”‚   â””â”€â”€ data.ts         # Fonctions de rÃ©cupÃ©ration
â””â”€â”€ ui/                 # Composants rÃ©utilisables â­ RÃ‰ORGANISÃ‰
    â”œâ”€â”€ common/          # Composants rÃ©utilisables (button, search, etc.)
    â”œâ”€â”€ forms/           # Formulaires (login, signup)
    â”œâ”€â”€ modals/          # Modales (level-up, rewards)
    â”œâ”€â”€ animations/      # Composants d'animation + CSS
    â”œâ”€â”€ icons/           # Logos et icÃ´nes
    â”œâ”€â”€ layouts/         # (RÃ©servÃ© pour futurs layouts)
    â”œâ”€â”€ activities/      # Composants spÃ©cifiques
    â”œâ”€â”€ badges/          # Badges
    â”œâ”€â”€ calendar/        # Calendrier
    â”œâ”€â”€ challenges/      # DÃ©fis
    â”œâ”€â”€ charts/          # Graphiques
    â”œâ”€â”€ dashboard/       # Dashboard
    â”œâ”€â”€ gallery/         # Galerie
    â”œâ”€â”€ settings/        # ParamÃ¨tres
    â”œâ”€â”€ global.css       # Styles globaux + thÃ¨mes
    â”œâ”€â”€ fonts.ts         # Configuration fonts
    â””â”€â”€ index.ts         # Barrel export pour imports simplifiÃ©s
prisma/
â”œâ”€â”€ schema.prisma        # SchÃ©ma de base de donnÃ©es
â””â”€â”€ seed.ts             # Script de peuplement
```

## ğŸ—„ï¸ Configuration Prisma

### ModÃ¨les de base de donnÃ©es
- **User** : Utilisateurs (name, email, passwordHash, role)
- **Activity** : Habitudes (name, frequency, color, icon)
- **ActivityLog** : Validations quotidiennes (date, isDone)
- **Challenge** : DÃ©fis entre utilisateurs
- **Badge** : Badges de rÃ©compense
- **UserBadge** : Association utilisateur-badges
- **Event** : Ã‰vÃ©nements communautaires
- **UserEvent** : Participation aux Ã©vÃ©nements
- **Motivation** : Messages de motivation
- **UserConnection** : Suivi des connexions

### Scripts Prisma disponibles
```bash
pnpm prisma:generate  # GÃ©nÃ©rer le client
pnpm prisma:push      # Sync DB
pnpm prisma:seed      # Peupler la DB
pnpm prisma:studio    # Interface graphique
```

### Utilisation du client Prisma
```typescript
import prisma from '@/app/lib/prisma';

// CrÃ©er une activitÃ©
const activity = await prisma.activity.create({
  data: {
    userId: 1,
    name: 'MÃ©ditation',
    frequency: 'daily',
    color: '#EC4899',
    icon: 'ğŸ§˜â€â™€ï¸'
  }
});

// RÃ©cupÃ©rer les activitÃ©s d'un utilisateur
const activities = await prisma.activity.findMany({
  where: { userId: 1 },
  include: { activityLogs: true }
});
```

### DonnÃ©es de test (aprÃ¨s seed)
**Admin :** `admin@habittracker.com` / `admin123`
**Test :** `user@test.com` / `password123`
**Badges :** 5 badges par dÃ©faut (ğŸŒŸ Premier pas, ğŸ”¥ RÃ©gularitÃ©, etc.)

## FonctionnalitÃ©s principales

### MVP (V1) - âœ… IMPLÃ‰MENTÃ‰
1. **Authentification** - Inscription/Connexion avec email/mot de passe
2. **Gestion d'activitÃ©s** - CRUD des habitudes avec frÃ©quence
3. **Validation quotidienne** - Marquer les habitudes comme rÃ©alisÃ©es
4. **Statistiques simples** - Pourcentage de rÃ©ussite par pÃ©riode
5. **Backoffice admin** - Stats globales pour les administrateurs

### FonctionnalitÃ©s avancÃ©es (V2/V3) - Ã€ VENIR
- SystÃ¨me de dÃ©fis entre utilisateurs
- Badges et gamification
- Ã‰vÃ©nements communautaires
- Personnalisation des activitÃ©s

## Conventions de dÃ©veloppement

### Nomenclature
- **Composants**: PascalCase (ex: `ActivityCard`, `LoginForm`)
- **Fichiers**: kebab-case (ex: `activity-list.tsx`, `user-profile.tsx`)
- **Variables**: camelCase (ex: `activityList`, `isCompleted`)
- **Constants**: UPPER_SNAKE_CASE (ex: `API_ENDPOINTS`, `DEFAULT_FREQUENCY`)

### Authentification
Utilise NextAuth.js v5 avec :
- Provider credentials pour email/password
- JWT pour les sessions
- Middleware pour la protection des routes
- RÃ´les utilisateur (user/admin)

## Guidelines pour Copilot

### Lors de la crÃ©ation de composants :
1. Toujours utiliser TypeScript avec des types stricts
2. ImplÃ©menter la responsivitÃ© mobile-first
3. Utiliser TailwindCSS pour le styling
4. Inclure les Ã©tats de loading et d'erreur
5. Ajouter l'accessibilitÃ© (aria-labels, semantic HTML)

### Pour les API Routes :
1. Valider les entrÃ©es avec Zod
2. GÃ©rer les erreurs avec des codes HTTP appropriÃ©s
3. Authentifier les requÃªtes avec getServerSession
4. Utiliser les types TypeScript pour les rÃ©ponses

### Pour les actions serveur :
1. Utiliser "use server" directive
2. Valider avec Zod
3. Utiliser Prisma pour les opÃ©rations DB
4. Revalider le cache appropriÃ© avec `revalidatePath()`
5. GÃ©rer les erreurs gracieusement

### Pour les requÃªtes Prisma :
1. Toujours utiliser `import prisma from '@/app/lib/prisma'`
2. Utiliser les types gÃ©nÃ©rÃ©s automatiquement
3. Inclure les relations nÃ©cessaires avec `include`
4. GÃ©rer les erreurs (unique constraints, not found, etc.)
5. Utiliser les transactions pour les opÃ©rations multiples

### Styling et UX :
- **Direction artistique**: Design rose/pink moderne
- Palette principale : `pink-500`, `rose-600`, `fuchsia-500`
- Fonds clairs : `pink-50`, `rose-50`, `pink-100`
- Animations subtiles pour les interactions
- Feedback visuel pour les actions (success/error)
- Interface intuitive pour le suivi d'habitudes
- Design mobile-first et responsive

Palette de couleurs :
- Primary: `pink-600` (#DB2777), `rose-600` (#E11D48)
- Accents: `pink-500`, `fuchsia-500`
- Backgrounds: `pink-50`, `rose-50`, `white/90`
- Text: `gray-800` (titres), `gray-600` (texte)
- Borders: `pink-200/50`

## ğŸš€ Commandes utiles

```bash
# DÃ©veloppement
pnpm dev                  # DÃ©marrer le serveur (port 3000)

# Base de donnÃ©es
pnpm prisma:generate      # GÃ©nÃ©rer le client Prisma
pnpm prisma:push          # Synchroniser la DB
pnpm prisma:seed          # Peupler avec donnÃ©es de test
pnpm prisma:studio        # Interface graphique DB

# Production
pnpm build                # Build pour production
pnpm start                # DÃ©marrer en production
```

## ğŸ“ Notes importantes

1. **Prisma Client** : Toujours importer depuis `@/app/lib/prisma` pour le singleton
2. **Variables d'environnement** : Utiliser `POSTGRES_PRISMA_URL` pour Prisma
3. **NextAuth** : Configurer `AUTH_SECRET` pour la production
4. **Types** : Prisma gÃ©nÃ¨re automatiquement les types aprÃ¨s `prisma:generate`
5. **Migrations** : Utiliser `prisma db push` en dev, `prisma migrate` en prod

---

## ğŸ¨ SystÃ¨me de thÃ¨mes (âœ… CORRIGÃ‰)

### ThÃ¨mes disponibles
L'application dispose de **5 thÃ¨mes** qui s'appliquent **globalement** et **instantanÃ©ment** :

1. **Light** (Rose) - Niveau 1 requis - ThÃ¨me par dÃ©faut
2. **Dark** (Ardoise) - Niveau 3 requis - Mode sombre complet
3. **Sunset** (Orange) - Niveau 3 requis - Ambiance chaleureuse
4. **Ocean** (Bleu) - Niveau 5 requis - Ambiance aquatique
5. **Forest** (Vert) - Niveau 7 requis - Ambiance naturelle

### Configuration technique

- **ThemeContext** (`app/context/ThemeContext.tsx`) :
  - Changement instantanÃ© sans rechargement de page
  - Application sur `<html>` ET `<body>`
  - Sauvegarde en base de donnÃ©es
  - Gestion d'Ã©tat avec hooks React

- **Styles** (`app/ui/global.css`) :
  - Variables CSS pour chaque thÃ¨me
  - Override complet des classes Tailwind
  - Transitions fluides (0.3s)
  - Support de TOUS les gradients

- **Layout** (`app/layout.tsx`) :
  - RÃ©cupÃ©ration du thÃ¨me utilisateur depuis la DB
  - Application initiale des classes de thÃ¨me
  - ThemeProvider enveloppe l'application

### Imports de composants UI

AprÃ¨s rÃ©organisation, utiliser :
```typescript
// âœ… Imports depuis les nouveaux dossiers
import { Button } from '@/app/ui/common/button';
import LoginForm from '@/app/ui/forms/login-form';
import HabitLogo from '@/app/ui/icons/habit-logo';
import { LevelUpModal } from '@/app/ui/modals/level-up-modal';

// âœ… Ou import simplifiÃ© depuis le barrel export
import { Button, LoginForm, HabitLogo } from '@/app/ui';
```

### Styling avec thÃ¨mes

Lors de l'Ã©criture de composants :
- Utiliser les classes Tailwind standard
- Les thÃ¨mes overrideront automatiquement les couleurs
- PrÃ©fÃ©rer `bg-linear-to-*` Ã  `bg-gradient-to-*` (config Tailwind custom)
- Les gradients colorÃ©s sont remplacÃ©s automatiquement en mode dark

Exemple :
```tsx
// Ce composant s'adapte automatiquement Ã  tous les thÃ¨mes
<div className="bg-white border border-gray-200 text-gray-900">
  <button className="bg-pink-500 hover:bg-pink-600 text-white">
    Valider
  </button>
</div>
```